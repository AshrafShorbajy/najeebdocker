version: "3.8"
services:
  provisioner:
    build:
      context: .
      dockerfile: Dockerfile.provisioner
    environment:
      SUPABASE_ACCESS_TOKEN: ${SUPABASE_ACCESS_TOKEN}
      PROJECT_REF: ${PROJECT_REF}
      SUPABASE_URL: ${SUPABASE_URL}
      SUPABASE_SERVICE_ROLE_KEY: ${SUPABASE_SERVICE_ROLE_KEY}
      ADMIN_EMAIL: ${ADMIN_EMAIL}
      ADMIN_PASSWORD: ${ADMIN_PASSWORD}
      ZOOM_WEBHOOK_SECRET: ${ZOOM_WEBHOOK_SECRET}
    restart: "no"
  web:
    build:
      context: .
      dockerfile: Dockerfile.web
    environment:
      SUPABASE_URL: ${SUPABASE_URL}
      SUPABASE_ANON_KEY: ${SUPABASE_ANON_KEY}
      ZOOM_WEBHOOK_URL: ${ZOOM_WEBHOOK_URL}
    ports:
      - "80:80"
    depends_on:
      - provisioner
